/////////////////////////////////////////////////////////////
//////////////////////// FOG BEGIN //////////////////////////
/////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////
/////////////////////// DECLARATION /////////////////////////
/////////////////////////////////////////////////////////////
vec4 fog(vec4 color, vec3 fragCameraPos);

/////////////////////////////////////////////////////////////
//////////////////////// UNIFORMS ///////////////////////////
/////////////////////////////////////////////////////////////
uniform int u_fog;
uniform vec3 u_fogColor;
uniform float u_density;
uniform float u_gradient;

/////////////////////////////////////////////////////////////
////////////////////////// MAIN /////////////////////////////
/////////////////////////////////////////////////////////////
vec4 fog(vec4 color, float distanceToCamera) {
    if (u_fog == 0) {
        return color;
    }

    float fragVisibility = exp(-pow(distanceToCamera * u_density, u_gradient));
    fragVisibility = clamp(fragVisibility, 0.0, 1.0);
    return mix(vec4(u_fogColor, 1.0), color, fragVisibility);
}

/////////////////////////////////////////////////////////////
///////////////////////// FOG END ///////////////////////////
/////////////////////////////////////////////////////////////
